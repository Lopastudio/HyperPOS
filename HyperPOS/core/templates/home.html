<!-- prettier-ignore -->
{% extends "master.html" %}
<!-- prettier-ignore -->
{% block title %} HyperPOS {% endblock %}
<!-- prettier-ignore -->
{% block content %}
<!-- prettier-ignore -->
{% if user.is_authenticated %}

<div class="container mx-auto mt-5">
  <form action="{% url 'atc_search' %}" method="post">
    {% csrf_token %}
    <input
      type="text"
      id="ean_search"
      name="ean_search"
      placeholder="EAN"
      class="w-full px-4 py-2 rounded-lg border border-gray-800 focus:outline-none focus:border-blue-500 text-black"
    />
    <button
      type="submit"
      class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"
    >
      Search
    </button>
  </form>
  

  <label for="search">Search:</label>
  <input
    type="text"
    id="search"
    name="search"
    placeholder="Search products..."
    class="w-full px-4 py-2 rounded-lg border border-gray-800 focus:outline-none focus:border-blue-500 text-black"
  />
  <table id="products" class="w-full mt-5 table-auto">
    <thead class="bg-gray-800">
      <tr>
        <th class="px-4 py-2">Product Name</th>
        <th class="px-4 py-2">Price</th>
        <th class="px-4 py-2">EAN</th>
      </tr>
    </thead>
    <tbody>
      {% for product in myproducts %}
      <tr class="bg-gray-100 hover:bg-gray-200 rounded-lg">
        <td class="px-4 py-2 text-gray-800">{{ product.name }}</td>
        <td class="px-4 py-2 text-gray-600">{{ product.price }}€</td>
        <td class="px-4 py-2 text-gray-600">{{ product.ean }}</td>
        <td class="px-4 py-2">
          <form
            action="{% url 'atc' product_id=product.ean %}"
            method="post"
          >
            {% csrf_token %}
            <button
              type="submit"
              class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"
            >
              Add to Cart
            </button>
          </form>
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="4" class="text-center py-4">No products available</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <hr class="my-8" />

  <div class="container mx-auto mt-5">
    <h2 class="text-2xl">Cart</h2>
    <table id="cart" class="w-full mt-5 table-auto">
      <thead class="bg-gray-800">
        <tr>
          <th class="px-4 py-2">Product Name</th>
          <th class="px-4 py-2">Price</th>
          <th class="px-4 py-2">Quantity</th>
          <th class="px-4 py-2">Total</th>
        </tr>
      </thead>
      <tbody>
        {% for item in cart %}
        <tr class="bg-gray-100 hover:bg-gray-200 rounded-lg">
          <td class="px-4 py-2 text-gray-800">{{ item.name }}</td>
          <td class="px-4 py-2 text-gray-600">{{ item.price }}€</td>
          <td class="px-4 py-2">
            <input
              type="number"
              name="quantity"
              value="{{ item.quantity }}"
              class="w-16 px-4 py-2 rounded-lg border border-gray-800 focus:outline-none focus:border-blue-500 text-gray-900"
            />
          </td>
          <td class="px-4 py-2 text-gray-600">{{ item.total }}€</td>
        </tr>
        {% endfor %}
      </tbody>
      <tfoot>
        <tr>
          <td colspan="3" class="text-right">Total:</td>
          <td id="checkout-total" class="px-4 py-2">{{ total }}</td>
        </tr>
      </tfoot>
    </table>

    <hr class="my-8" />

    <div id="payment" class="card mb-5">
      <div class="card-body flex items-center">
        <div class="form-group mr-4">
          <label for="amount">Amount of given money:</label>
          <input
            type="number"
            id="amount"
            name="amount"
            min="0"
            step="0.01"
            class="w-48 px-4 py-2 rounded-lg border border-gray-800 focus:outline-none focus:border-blue-500 text-gray-900"
          />
        </div>
        <button
          id="cash-payment-button"
          class="btn btn-primary mr-2 bg-green-500 hover:bg-green-600"
        >
          Cash Payment
        </button>
        <button
          id="button-clear"
          class="btn btn-danger mr-2 bg-gray-600 hover:bg-gray-700"
        >
          Clear Basket
        </button>
        <button
          id="card-payment-button"
          class="btn btn-primary bg-red-500 hover:bg-red-600"
        >
          Pay with Card
        </button>
      </div>
    </div>
    <br />
    <footer class="text-center">
      <h4 class="mb-4">
        Made with ❤️ by <a href="https://lopastudio.sk"><u>Patrik Nagy</u></a>
      </h4>
      <h4>(C) Lopastudio 2023 - 2024</h4>
    </footer>
  </div>

  {% else %}
  <p>You are not authenticated in</p>
  <a href="{% url 'login' %}">Log In</a>
  {% endif %} {% endblock %}
</div>
